<!doctype html><html><head><title>Services :: Lucid</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=revised content="2021-01-04T11:32:03 UTC"><meta name=description content><title>Services :: Lucid</title><link rel="shortcut icon" href=/images/favicon.png type=image/x-icon><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css integrity=sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.css><script src=https://code.jquery.com/jquery-3.5.1.min.js></script><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel=stylesheet><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/layout.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/css/style.main.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/css/style.menu.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/notice.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/tabs.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/panel.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/columns.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/children.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/attachments.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/alert.css><link rel=stylesheet type=text/css href=/css/docport.css><script src=/js/docport.js></script><script type=text/javascript>var baseurl="https:\/\/docs.lucidarch.dev";</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-96232175-1','auto');ga('send','pageview');}</script><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=/css/syntax.css><link rel=apple-touch-icon sizes=180x180 href=/icon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/icon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/icon/favicon-16x16.png><link rel=manifest href=/icon/site.webmanifest><script async defer src=https://buttons.github.io/buttons.js></script></head><body data-url=/services/ class=hideheader><style type=text/css>#debug{display:-webkit-box;display:-ms-flexbox;display:flex;line-height:3.5rem;margin-bottom:.35rem;padding:0 2rem;position:fixed;left:0;right:0;top:0;top:0;min-height:150px;background-color:#fff;border:3px solid red;z-index:10000;word-wrap:all;overflow:auto}</style><article><aside><div class=search><div class=searchbox><input data-search-input id=search-by type=text placeholder="Type to search..."></div><script type=text/javascript src=/vendor/lunr/lunr.min.js></script><script type=text/javascript src=/vendor/auto-complete/auto-complete.js></script><link href=/vendor/auto-complete/auto-complete.css rel=stylesheet><script type=text/javascript>var baseurl="https:\/\/docs.lucidarch.dev";</script><script type=text/javascript src=/js/search.js></script></div><div style=margin-top:30px><a href=/concept style=display:flex;justify-content:left;align-items:center><img src=/icon/logo.png width=250 style=margin-left:10px></a></div><div id=close_menu><a href=javascript:void(0); style=font-size:15px onclick="$('article > aside').toggleClass('responsive')"><i class="fa fa-lg fa-times"></i></a></div><ul class=menu><li data-nav-id=https://docs.lucidarch.dev/concept/ class="dd-item
alwaysopen
item_level_$level"><a href=/concept/>Concept</a></li><li data-nav-id=https://docs.lucidarch.dev/philosophy/ class="dd-item
alwaysopen
item_level_$level"><a href=/philosophy/>Philosophy</a></li><li data-nav-id=https://docs.lucidarch.dev/principles/ class="dd-item
alwaysopen
item_level_$level"><a href=/principles/>Principles</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/installation/ class="dd-item
alwaysopen
item_level_$level"><a href=/installation/>Installation</a></li><li data-nav-id=https://docs.lucidarch.dev/upgrade-guide/ class="dd-item
alwaysopen
item_level_$level"><a href=/upgrade-guide/>Upgrade Guide</a></li><li data-nav-id=https://docs.lucidarch.dev/getting-started/ class="dd-item
alwaysopen
item_level_$level"><a href=/getting-started/>Getting Started</a></li><li data-nav-id=https://docs.lucidarch.dev/micro-vs-monolith/ class="dd-item
alwaysopen
item_level_$level"><a href=/micro-vs-monolith/>Micro • Monolith</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/routing/ class="dd-item
alwaysopen
item_level_$level"><a href=/routing/>Routing</a></li><li data-nav-id=https://docs.lucidarch.dev/controllers/ class="dd-item
alwaysopen
item_level_$level"><a href=/controllers/>Controllers</a></li><li data-nav-id=https://docs.lucidarch.dev/features/ class="dd-item
alwaysopen
item_level_$level"><a href=/features/>Features</a></li><li data-nav-id=https://docs.lucidarch.dev/jobs/ class="dd-item
alwaysopen
item_level_$level"><a href=/jobs/>Jobs</a></li><li data-nav-id=https://docs.lucidarch.dev/operations/ class="dd-item
alwaysopen
item_level_$level"><a href=/operations/>Operations</a></li><li data-nav-id=https://docs.lucidarch.dev/services/ class="dd-item parent active
alwaysopen
item_level_$level"><a href=/services/>Services</a></li><li data-nav-id=https://docs.lucidarch.dev/domains/ class="dd-item
alwaysopen
item_level_$level"><a href=/domains/>Domains</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/validation/ class="dd-item
alwaysopen
item_level_$level"><a href=/validation/>Validation</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/cli/ class="dd-item
alwaysopen
item_level_$level"><a href=/cli/>CLI Reference</a></li></ul></aside><section class=page><nav id=ariane aria-label=breadcrumb><ol class=ariane><li><a class=text-link href=https://docs.lucidarch.dev>Home</a></li><li class=active>Services</li></ol></nav><h1>Services</h1><div class=jump-to-section><span onclick="$h=$(this);$h.next('nav').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('nav').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right';});});"><span class="fas fa-align-right"></span>Jump to Section
<i class="fas fa-chevron-right"></i></span><nav id=TableOfContents><ul><li><a href=#structure>Structure</a><ul><li><a href=#routes-showcase>Routes Showcase</a></li><li><a href=#controllers-showcase>Controllers Showcase</a></li></ul></li><li><a href=#benefits>Benefits</a></li><li><a href=#create-a-service>Create a Service</a><ul><li><a href=#register-service>Register Service</a></li><li><a href=#run-service-tests>Run Service Tests</a></li></ul></li><li><a href=#working-with-services>Working with Services</a><ul><li><a href=#controllers>Controllers</a></li><li><a href=#features>Features</a></li><li><a href=#operations>Operations</a></li><li><a href=#migrations>Migrations</a></li><li><a href=#lang--views>Lang & Views</a></li><li><a href=#tests>Tests</a></li><li><a href=#providers>Providers</a></li></ul></li><li><a href=#a-note-on-microservices>A Note On Microservices</a></li><li><a href=#soa--lucid>SOA & Lucid</a><ul><li><a href=#are-lucid-services-complient-to-soa>Are Lucid Services Complient to SOA?</a></li></ul></li></ul></nav></div><div class=content><p>Are the differentiating factors of Monolith. Their presence is necessary in multi-purpose projects
that are set to scale in several areas of functionalities, <em>a.k.a horizonal growth</em>.
They communicate with domains to compose jobs into groups of functionalities in their own features and operations.</p><p><img src=/media/images/services/services.png alt="Lucid Services"></p><h2 ref=structure>Structure</h2><a class=anchor id=structure></a><p>Services are structured for scale, by adding an encapsulation layer for features, operations, routes, controllers, commands, resources (views)
providers, tests and database; allowing our application to contain sections that differ in high degree and have plenty of those without causing
clutter yet keep code navigation straight-forward.</p><p>The example below illustrates a comparison between a Lucid Monolith and a traditional directory separation in an application that
has Chat, Product Management, Forum, Api and Admin listed with their features below:</p><div class=columns><div class=column><ul><li>Chat<ul><li>Send message</li><li>Update message</li><li>Delete message</li><li>Share message</li><li>Connect to channel</li><li>Search messages</li></ul></li><li>Forum<ul><li>CRUD questions</li><li>Manage questions in categories</li><li>Schedule newsletter update</li><li>Set answer as accepted</li><li>Promote user as member</li><li>Follow/unfollow question</li><li>Search questions</li><li>SEO</li></ul></li></ul></div><div class=column><ul><li>Product Management<ul><li>CRUD product</li><li>Add product to category</li><li>Update product price</li><li>Update product availability</li><li>Search products</li></ul></li><li>Admin<ul><li>CRUD users</li><li>CRUD organizations</li><li>CRUD products</li><li>CRUD projects</li></ul></li><li>Api<ul><li>CRUD application (like Slack & Facebook apps etc.)</li><li>Send message</li><li>Subscribe to product updates</li><li>Subscribe to question updates</li></ul></li></ul></div></div><p>An application this large will easily grow in files and directories to unmaintainable extents. To avoid that, we&rsquo;ll create services
for each to hold all their needs to function, which is exactly what&rsquo;s initially in Laravel&rsquo;s <code>/app</code> directory, in addition to tests.</p><pre>
app/Services/Chat
├── Console
│   └── Commands
├── <strong>Features</strong>
├── <strong>Operations</strong>
├── Http
│   ├── Controllers
│   └── Middleware
├── Providers
│   ├── ChatServiceProvider.php
│   ├── BroadcastServiceProvider.php
│   └── RouteServiceProvider.php
├── <strong>Tests</strong>
│   └── <strong>Features</strong>
│   └── <strong>Operations</strong>
├── database
│   ├── factories
│   ├── migrations
│   └── seeds
├── resources
│   ├── lang
│   └── views
└── routes
    ├── api.php
    ├── channels.php
    ├── console.php
    └── web.php
</pre><div class="notices info"><p><i class="fas fa-info-circle"></i> This is the initial structure of a service, however you may choose to customise it for what it needs only, for example if you
prefer to have the database stuff at the root or that this service doesn&rsquo;t have any database work to do on its own,
you would simply remove it from within the service. Similar for Console and everything else.</p></div><hr><p>Here&rsquo;s an illustrative comparison between the traditional and the services approaches in routing and controllers:</p><h3 ref=routes-showcase>Routes Showcase</h3><a class=anchor id=routes-showcase></a><p><strong>Traditional</strong></p><p>Using the traditional approach where all of our routes are in <code>routes/web.php</code>, we&rsquo;ll find that this file will keep growing
the more functionalities we add. Also, if more than a single person is working on it, it is highly likely to produce conflicts
on merge which is always an unpleasant experience.</p><div class="notices light"><p><i class="fas fa-info-circle"></i> Expand file locations to see their code.</p></div><span class=lucid-code-expand><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right';});});"><i class="fas fa-chevron-right"></i><span>routes/web.php</span></div><div class=expand-content style=display:none><script type=application/javascript src=https://gist.github.com/mulkave/89eb6b9c6b0f9ab8574ab8e7a32aa8d2.js></script></div></div></span><span class=lucid-code-expand><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right';});});"><i class="fas fa-chevron-right"></i><span>routes/api.php</span></div><div class=expand-content style=display:none><script type=application/javascript src=https://gist.github.com/mulkave/316bf292318f16862103b248c363d38c.js></script></div></div></span><p>Of course there are ways to separate routes into several files and load them in the service provider, but routing isn&rsquo;t
the only problem that we will be facing, it is just a part of it.</p><p><strong>Lucid Service Routes Showcase</strong></p><p>On the other hand, with services we&rsquo;ve separated these routes files where they belong to have a pleasant experience working with them
and avoid conflicts as a team.</p><span class=lucid-code-expand><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right';});});"><i class="fas fa-chevron-right"></i><span>app/Services/Chat/routes/web.php</span></div><div class=expand-content style=display:none><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=nx>Route</span><span class=o>::</span><span class=na>middleware</span><span class=p>([</span><span class=s1>&#39;auth&#39;</span><span class=p>,</span> <span class=s1>&#39;subscription&#39;</span><span class=p>])</span><span class=o>-&gt;</span><span class=na>group</span><span class=p>(</span><span class=s1>&#39;chat&#39;</span><span class=p>,</span> <span class=k>function</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/messages&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ChatController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;sendMessage&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=s1>&#39;/messages/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ChatController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;updateMessage&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/messages/{id}/share&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ChatController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;shareMessage&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/channels/{channel}/connect&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ChatController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;connect&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/search&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ChatController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;search&#39;</span><span class=p>]);</span>
<span class=p>});</span>
</code></pre></div></div></div></span><span class=lucid-code-expand><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right';});});"><i class="fas fa-chevron-right"></i><span>app/Services/Forum/routes/web.php</span></div><div class=expand-content style=display:none><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=nx>Route</span><span class=o>::</span><span class=na>middleware</span><span class=p>([</span><span class=s1>&#39;auth&#39;</span><span class=p>,</span> <span class=s1>&#39;subscription&#39;</span><span class=p>])</span><span class=o>-&gt;</span><span class=na>group</span><span class=p>(</span><span class=s1>&#39;forum&#39;</span><span class=p>,</span> <span class=k>function</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;/questions&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ForumController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;questions&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/questions&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ForumController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;addQuestion&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=s1>&#39;/questions/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ForumController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;updateQuestion&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>delete</span><span class=p>(</span><span class=s1>&#39;/questions/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ForumController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;deleteQuestion&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=s1>&#39;/questions/{id}/category&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ForumController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;category&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=s1>&#39;/questions/{id}/accept&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ForumController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;accept&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/questions/{id}/follow&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ForumUserController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;follow&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;/questions/search&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ForumUserController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;search&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=s1>&#39;/users/{id}/promote&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ForumUserController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;promote&#39;</span><span class=p>]);</span>
<span class=p>});</span>
</code></pre></div></div></div></span><span class=lucid-code-expand><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right';});});"><i class="fas fa-chevron-right"></i><span>app/Services/Products/routes/web.php</span></div><div class=expand-content style=display:none><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=nx>Route</span><span class=o>::</span><span class=na>middleware</span><span class=p>([</span><span class=s1>&#39;auth&#39;</span><span class=p>,</span> <span class=s1>&#39;subscription&#39;</span><span class=p>])</span><span class=o>-&gt;</span><span class=na>group</span><span class=p>(</span><span class=s1>&#39;products&#39;</span><span class=p>,</span> <span class=k>function</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;/search&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ProductController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;search&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ProductController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;get&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ProductController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;show&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ProductController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;add&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=s1>&#39;/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ProductController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;update&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>delete</span><span class=p>(</span><span class=s1>&#39;/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ProductController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;delete&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=s1>&#39;/{id}/category&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ProductController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;category&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=s1>&#39;/{id}/price&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ProductController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=s1>&#39;/{id}/stock&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ProductController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;stock&#39;</span><span class=p>]);</span>
<span class=p>});</span>
</code></pre></div></div></div></span><span class=lucid-code-expand><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right';});});"><i class="fas fa-chevron-right"></i><span>app/Services/Api/routes/api.php</span></div><div class=expand-content style=display:none><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=nx>Route</span><span class=o>::</span><span class=na>middleware</span><span class=p>([</span><span class=s1>&#39;throttle:api&#39;</span><span class=p>])</span><span class=o>-&gt;</span><span class=na>group</span><span class=p>(</span><span class=s1>&#39;api&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>()</span> <span class=p>{</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;/apps/search&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>AppController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;search&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;/apps&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>AppController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;get&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;/apps/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>AppController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;show&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/apps&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>AppController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;add&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>put</span><span class=p>(</span><span class=s1>&#39;/apps/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>AppController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;update&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>delete</span><span class=p>(</span><span class=s1>&#39;/apps/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>AppController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;delete&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/channels/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ChatController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;subscribe&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/products/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ProductController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;subscribe&#39;</span><span class=p>]);</span>
    <span class=nx>Route</span><span class=o>::</span><span class=na>post</span><span class=p>(</span><span class=s1>&#39;/questions/{id}&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>ForumController</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=s1>&#39;subscribe&#39;</span><span class=p>]);</span>
<span class=p>});</span>
</code></pre></div></div></div></span><span class=lucid-code-expand><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right';});});"><i class="fas fa-chevron-right"></i><span>app/Services/Admin/routes/web.php</span></div><div class=expand-content style=display:none><script type=application/javascript src=https://gist.github.com/mulkave/37bb21541cf42f2cafa6f3fe98c8e0c3.js></script></div></div></span><p>Another variation of routes would be to reduce Admin routes by including them in their corresponding services instead of having
Admin service include them all. Both approaches have their benefits so you may choose whichever works best for your case.</p><span class=lucid-code-expand><div class=expand><div class=expand-label style=cursor:pointer onclick="$h=$(this);$h.next('div').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('div').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right';});});"><i class="fas fa-chevron-right"></i><span>app/Services/Products/routes/web.php</span></div><div class=expand-content style=display:none><script type=application/javascript src=https://gist.github.com/mulkave/72777eabde48996067daf968b62c468f.js></script></div></div></span><hr><h3 ref=controllers-showcase>Controllers Showcase</h3><a class=anchor id=controllers-showcase></a><p>Consolidating routes and controllers in services allows us to have them side-by-side within the same context, so that we don&rsquo;t
have to go digging for code in foreign directories.</p><div class=columns><div class=column><p><strong>Traditional</strong></p><pre>
app/Http/Controllers
├── Admin
│   ├── ProductController.php
│   ├── ForumController.php
│   ├── UserController.php
│   └── OrganizationController.php
├── Api
│   ├── AppController.php
│   ├── ChatController.php
│   └── HookController.php
├── Chat
│   └── MessageController.php
├── Products
│   └── ProductController.php
└── Forum
    ├── QuestionController.php
    ├── CategoryController.php
    └── MemberController.php
</pre></div><div class=column><p><strong>Lucid Service Controllers</strong></p><pre>
app/Services/Admin/Http/Controllers
   ├── ProductController.php
   ├── ForumController.php
   ├── UserController.php
   └── OrganizationController.php

app/Services/Api/Http/Controllers
   ├── AppController.php
   ├── ChatController.php
   └── HookController.php

app/Services/Chat/Http/Controllers
   └── MessageController.php

app/Services/ProductManagement/Http/Controllers
   └── ProductController.php

app/Services/Forum/Http/Controllers
    ├── QuestionController.php
    ├── MemberController.php
    └── CategoryController.php
</pre></div></div><hr><h2 ref=benefits>Benefits</h2><a class=anchor id=benefits></a><div class=columns><div class=column><div class=card><div class=card-body><p class=card-text><h3 ref=concentration>Concentration</h3><a class=anchor id=concentration></a><p>Working on a feature in a service wouldn&rsquo;t concern you with others outside the bounds of said service.</p></p></div></div></div><div class=column><div class=card><div class=card-body><p class=card-text><h3 ref=efficiency>Efficiency</h3><a class=anchor id=efficiency></a><p>Reduced code review time and merge conflicts when working with a team, due to the separation of concerns.</p></p></div></div></div><div class=column><div class=card><div class=card-body><p class=card-text><h3 ref=separation>Separation</h3><a class=anchor id=separation></a><p>Consider having Single Responsibility and Separation of Concerns, not only at the code level, but also in the structure.</p></p></div></div></div></div><div class="notices info"><p><i class="fas fa-asterisk"></i> Remember that it is completely optional to use Services. In fact there is no obligation
whatsoever with Lucid, pick any unit from the stack and use it to your convenience; just preserve Lucid&rsquo;s guidelines as you do.</p></div><h2 ref=create-a-service>Create a Service</h2><a class=anchor id=create-a-service></a><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>lucid make:service Chat
</code></pre></div><p>This will generate the directory structure for a service in <code>app/Services/Chat/*</code></p><pre>
app/Services/Chat
├── Console
│   └── Commands
├── <strong>Features</strong>
├── <strong>Operations</strong>
├── Http
│   ├── Controllers
│   └── Middleware
├── Providers
│   ├── ChatServiceProvider.php
│   ├── BroadcastServiceProvider.php
│   └── RouteServiceProvider.php
├── <strong>Tests</strong>
│   └── <strong>Features</strong>
│   └── <strong>Operations</strong>
├── database
│   ├── factories
│   ├── migrations
│   └── seeds
├── resources
│   ├── lang
│   └── views
└── routes
    ├── api.php
    ├── channels.php
    ├── console.php
    └── web.php
</pre><h3 ref=register-service>Register Service</h3><a class=anchor id=register-service></a><p>Once created we&rsquo;ll need to tell Laravel about our service so that it loads its files such as routes, migrations, views and others.
There are two ways to register the service&rsquo;s provider, in this case it&rsquo;s <code>ChatServiceProvider</code>:</p><p><strong>1. In Configuration: <code>config/app.php</code></strong></p><p>Add <code>App\Services\Chat\Providers\ChatServiceProvider::class</code> to <code>'providers'</code> in <code>config/app.php</code></p><p>This will register and load the service every time the application launches.</p><p><strong>2. In <code>AppServiceProvider::register</code></strong></p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>

<span class=k>namespace</span> <span class=nx>App\Providers</span><span class=p>;</span>

<span class=k>use</span> <span class=nx>Illuminate\Support\ServiceProvider</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>App\Services\Api\Providers\ApiServiceProvider</span><span class=p>;</span>

<span class=k>class</span> <span class=nc>AppServiceProvider</span> <span class=k>extends</span> <span class=nx>ServiceProvider</span>
<span class=p>{</span>
    <span class=sd>/**
</span><span class=sd>     * Register any application services.
</span><span class=sd>     *
</span><span class=sd>     * @return void
</span><span class=sd>     */</span>
    <span class=k>public</span> <span class=k>function</span> <span class=nf>register</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>register</span><span class=p>(</span><span class=nx>ApiServiceProvider</span><span class=o>::</span><span class=na>class</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>This opens up possibilities for conditional registration of services. For example you may choose to load Dashboard service
only when in the local environment:</p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=k>public</span> <span class=k>function</span> <span class=nf>register</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=nx>App</span><span class=o>::</span><span class=na>environment</span><span class=p>(</span><span class=s1>&#39;local&#39;</span><span class=p>))</span> <span class=p>{</span>
        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>register</span><span class=p>(</span><span class=nx>DashboardServiceProvider</span><span class=o>::</span><span class=na>class</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><h3 ref=run-service-tests>Run Service Tests</h3><a class=anchor id=run-service-tests></a><p>Initially service tests are part of the default testsuite, but in case you wish to run a single service&rsquo;s tests in isolation
please add the following to your <code>phpunit.xml</code> under <code>&lt;testsuites></code> (must be done for each service),
and then we would be able to use <code>phpunit --testsuite &lt;name></code> to run them.</p><div class=highlight><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;testsuite</span> <span class=na>name=</span><span class=s>&#34;Chat&#34;</span><span class=nt>&gt;</span>
    <span class=nt>&lt;directory</span> <span class=na>suffix=</span><span class=s>&#34;Test.php&#34;</span><span class=nt>&gt;</span>./tests/Feature/Services/Chat<span class=nt>&lt;/directory&gt;</span>
    <span class=nt>&lt;directory</span> <span class=na>suffix=</span><span class=s>&#34;Test.php&#34;</span><span class=nt>&gt;</span>./tests/Unit/Services/Chat<span class=nt>&lt;/directory&gt;</span>
<span class=nt>&lt;/testsuite&gt;</span>
</code></pre></div><p>Now we can run the tests for this service in isolation:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>phpunit --testsuite Chat
</code></pre></div><h2 ref=working-with-services>Working with Services</h2><a class=anchor id=working-with-services></a><p>All unit generation commands (<code>lucid make:*</code>) have an optional parameter <code>&lt;service></code> to specify which service you&rsquo;d like to generate the unit into.</p><div class="notices light"><p><i class="fas fa-info-circle"></i> command parameters are case-insensitive, Lucid will try to convert to the corresponding case.</p></div><h3 ref=controllers>Controllers</h3><a class=anchor id=controllers></a><p><strong>Signature</strong> <code>lucid make:controller &lt;controller> &lt;service></code></p><p><strong>Example</strong></p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>lucid make:controller message chat
</code></pre></div><p>Will generate <code>app/Services/Chat/Http/Controllers/MessageController.php</code></p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>

<span class=k>namespace</span> <span class=nx>App\Services\Chat\Http\Controllers</span><span class=p>;</span>

<span class=k>use</span> <span class=nx>Lucid\Units\Controller</span><span class=p>;</span>

<span class=k>class</span> <span class=nc>MessageController</span> <span class=k>extends</span> <span class=nx>Controller</span>
<span class=p>{</span>

<span class=p>}</span>
</code></pre></div><h3 ref=features>Features</h3><a class=anchor id=features></a><p><strong>Signature</strong> <code>lucid make:feature &lt;feature> &lt;service></code></p><p><strong>Example</strong></p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>lucid make:feature SendMessage chat
</code></pre></div><p>Will generate <code>app/Services/Chat/Features/SendMessageFeature.php</code></p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>

<span class=k>namespace</span> <span class=nx>App\Services\Chat\Features</span><span class=p>;</span>

<span class=k>use</span> <span class=nx>Lucid\Units\Feature</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Illuminate\Http\Request</span><span class=p>;</span>

<span class=k>class</span> <span class=nc>SendMessageFeature</span> <span class=k>extends</span> <span class=nx>Feature</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>(</span><span class=nx>Request</span> <span class=nv>$request</span><span class=p>)</span>
    <span class=p>{</span>

    <span class=p>}</span>
<span class=p>}</span>

</code></pre></div><h3 ref=operations>Operations</h3><a class=anchor id=operations></a><p><strong>Signature</strong> <code>lucid make:operation &lt;operation> &lt;service></code></p><p><strong>Example</strong></p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>lucid make:operation EnqueueMessageForSending chat
</code></pre></div><p>Will generate <code>app/Services/Chat/Operations/EnqueueMessageForSendingOperation.php</code></p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>

<span class=k>namespace</span> <span class=nx>App\Services\Chat\Operations</span><span class=p>;</span>

<span class=k>use</span> <span class=nx>Lucid\Units\Operation</span><span class=p>;</span>

<span class=k>class</span> <span class=nc>EnqueueMessageForSendingOperation</span> <span class=k>extends</span> <span class=nx>Operation</span>
<span class=p>{</span>
    <span class=sd>/**
</span><span class=sd>     * Create a new operation instance.
</span><span class=sd>     *
</span><span class=sd>     * @return void
</span><span class=sd>     */</span>
    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=c1>//
</span><span class=c1></span>    <span class=p>}</span>

    <span class=sd>/**
</span><span class=sd>     * Execute the operation.
</span><span class=sd>     *
</span><span class=sd>     * @return void
</span><span class=sd>     */</span>
    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>()</span>
    <span class=p>{</span>

    <span class=p>}</span>
<span class=p>}</span>

</code></pre></div><h3 ref=migrations>Migrations</h3><a class=anchor id=migrations></a><p>When generated, migrations are automatically registered in the global application&rsquo;s migrations so Laravel knows about them
and running them can be done simply by using <code>php arisan migrate</code>. This is done in the Service&rsquo;s
service provider class (in our example it&rsquo;s <code>ChatServiceProvider</code>) that we added to our app&rsquo;s <code>providers</code> upon creation.</p><h4 ref=generate-migration>Generate Migration</h4><a class=anchor id=generate-migration></a><p><strong>Signature</strong> <code>lucid make:migration &lt;migration> &lt;service></code></p><p><strong>Example</strong></p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>lucid make:migration create_messages_table chat
</code></pre></div><p>Will generate <code>app/Services/Chat/database/migrations/{date}_create_messages_table.php</code></p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>

<span class=k>use</span> <span class=nx>Illuminate\Database\Migrations\Migration</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Illuminate\Database\Schema\Blueprint</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Illuminate\Support\Facades\Schema</span><span class=p>;</span>

<span class=k>class</span> <span class=nc>CreateMessagesTable</span> <span class=k>extends</span> <span class=nx>Migration</span>
<span class=p>{</span>
    <span class=sd>/**
</span><span class=sd>     * Run the migrations.
</span><span class=sd>     *
</span><span class=sd>     * @return void
</span><span class=sd>     */</span>
    <span class=k>public</span> <span class=k>function</span> <span class=nf>up</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=nx>Schema</span><span class=o>::</span><span class=na>create</span><span class=p>(</span><span class=s1>&#39;messages&#39;</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nx>Blueprint</span> <span class=nv>$table</span><span class=p>)</span> <span class=p>{</span>
            <span class=nv>$table</span><span class=o>-&gt;</span><span class=na>id</span><span class=p>();</span>
            <span class=nv>$table</span><span class=o>-&gt;</span><span class=na>timestamps</span><span class=p>();</span>
        <span class=p>});</span>
    <span class=p>}</span>

    <span class=sd>/**
</span><span class=sd>     * Reverse the migrations.
</span><span class=sd>     *
</span><span class=sd>     * @return void
</span><span class=sd>     */</span>
    <span class=k>public</span> <span class=k>function</span> <span class=nf>down</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=nx>Schema</span><span class=o>::</span><span class=na>dropIfExists</span><span class=p>(</span><span class=s1>&#39;messages&#39;</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><h4 ref=run-service-migrations>Run Service Migrations</h4><a class=anchor id=run-service-migrations></a><p>Our migrations are recognized by Laravel due to them being loaded automatically in the service provider - <code>ChatServiceProvider</code> in this example.</p><p>Which makes it straight-forward to run them:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>php artisan migrate
</code></pre></div><h4 ref=removing-migrations>Removing Migrations</h4><a class=anchor id=removing-migrations></a><p>In the case where your service doesn&rsquo;t use any of the database functionalities and you&rsquo;d like to tidy up by deleting the <code>database</code>
folder, make sure you remove the following from the service provider - typically at <code>app/Services/{name}/Providers/{name}ServiceProvider.php</code></p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=k>public</span> <span class=k>function</span> <span class=nf>boot</span><span class=p>()</span>
<span class=p>{</span>
    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>loadMigrationsFrom</span><span class=p>([</span>
        <span class=nx>realpath</span><span class=p>(</span><span class=no>__DIR__</span> <span class=o>.</span> <span class=s1>&#39;/../database/migrations&#39;</span><span class=p>)</span>
    <span class=p>]);</span>
<span class=p>}</span>
</code></pre></div><h3 ref=lang--views>Lang & Views</h3><a class=anchor id=lang--views></a><p>Each service is provided with its own <code>resources</code> directory that resembles Laravel&rsquo;s, containing <code>views</code> and <code>lang</code>.
All the files that are created there will be registered under a namespace named in snake_case after the service&rsquo;s name.</p><p>This is initially done in the Service Provider upon creating the service, for example in <code>ChatServiceProvider::registerResources</code>:</p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=k>protected</span> <span class=k>function</span> <span class=nf>registerResources</span><span class=p>()</span>
<span class=p>{</span>
    <span class=c1>// Translation must be registered ahead of adding lang namespaces
</span><span class=c1></span>    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>register</span><span class=p>(</span><span class=nx>TranslationServiceProvider</span><span class=o>::</span><span class=na>class</span><span class=p>);</span>

    <span class=nx>Lang</span><span class=o>::</span><span class=na>addNamespace</span><span class=p>(</span><span class=s1>&#39;chat&#39;</span><span class=p>,</span> <span class=nx>realpath</span><span class=p>(</span><span class=no>__DIR__</span><span class=o>.</span><span class=s1>&#39;/../resources/lang&#39;</span><span class=p>));</span>

    <span class=nx>View</span><span class=o>::</span><span class=na>addNamespace</span><span class=p>(</span><span class=s1>&#39;chat&#39;</span><span class=p>,</span> <span class=nx>base_path</span><span class=p>(</span><span class=s1>&#39;resources/views/vendor/chat&#39;</span><span class=p>));</span>
    <span class=nx>View</span><span class=o>::</span><span class=na>addNamespace</span><span class=p>(</span><span class=s1>&#39;chat&#39;</span><span class=p>,</span> <span class=nx>realpath</span><span class=p>(</span><span class=no>__DIR__</span><span class=o>.</span><span class=s1>&#39;/../resources/views&#39;</span><span class=p>));</span>
<span class=p>}</span>
</code></pre></div><p>To use these views simply prepend them with their corresponding namespace <code>{namespace}::{view}</code>.</p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=nx>Route</span><span class=o>::</span><span class=na>get</span><span class=p>(</span><span class=s1>&#39;/chat&#39;</span><span class=p>,</span> <span class=k>function</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>view</span><span class=p>(</span><span class=s1>&#39;chat::welcome&#39;</span><span class=p>);</span>
<span class=p>});</span>
</code></pre></div><p>For multi-word services such as <code>ProductManagement</code> it will be <code>product_management::welcome</code>.</p><p>If your service doesn&rsquo;t use views and you&rsquo;d like to de-clutter, feel free to remove the <code>resources</code> folder altogether and
remember to remove <code>registerResources</code> method from the service provider as well as its call in <code>register</code>.</p><h3 ref=tests>Tests</h3><a class=anchor id=tests></a><p>Testing services is about testing their features and operations, they&rsquo;re scoped according to the type of test:</p><ul><li>Feature: <code>tests/Feature/Services/{service}/{Feature}Test.php</code></li><li>Operation: <code>tests/Unit/Services/{service}/{Operation}Test.php</code></li></ul><p>Other tests that belong to the service can be placed in correspondance to the above.</p><p>It is also recommended to namespace your test classes just to avoid conflicts. This is done by default for features and operations
that are generated using <code>lucid make:*</code> following PSR-4 standard. An initial test could look like this:</p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>

<span class=k>namespace</span> <span class=nx>Tests\Feature\Services\Chat</span><span class=p>;</span>

<span class=k>use</span> <span class=nx>Tests\TestCase</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>App\Services\Chat\Features\SendMessageFeature</span><span class=p>;</span>

<span class=k>class</span> <span class=nc>SendMessageFeatureTest</span> <span class=k>extends</span> <span class=nx>TestCase</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=k>function</span> <span class=nf>test_sendmessagefeature</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>markTestIncomplete</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><h3 ref=providers>Providers</h3><a class=anchor id=providers></a><p>Service providers are the connecting wires between the Lucid stack and Laravel especially when it comes to services,
they are used to tell Laravel where our code is and what to load, from where, and when.</p><p>Each service comes with its own set of providers in <code>app/Services/{service}/Providers</code> and most essentially the service&rsquo;s own
provider that is usually named after the service <em>e.g. <code>ChatServiceProvider</code> or <code>ProductManagementServiceProvider</code></em>.</p><p>For Laravel to know about our service and load its files such as database migrations, lang, views and any other classes and elements
you would like to register in that service specifically, the service provider must be part of <code>providers</code> in <code>config/app.php</code></p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=s1>&#39;providers&#39;</span> <span class=o>=&gt;</span> <span class=p>[</span>
    <span class=o>...</span>
    <span class=nx>App\Services\Api\Providers\ApiServiceProvider</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
    <span class=nx>App\Services\Chat\Providers\ChatServiceProvider</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
    <span class=nx>App\Services\ProductManagement\Providers\ProductManagementServiceProvider</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
<span class=p>]</span>
</code></pre></div><h4 ref=custom-service-provider>Custom Service Provider</h4><a class=anchor id=custom-service-provider></a><p>We can create and register our own providers which allows us to segregate functionality further within our services:</p><p><code>app/Services/Chat/Providers/RiakServiceProvider</code></p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=o>&lt;?</span><span class=nx>php</span>

<span class=k>namespace</span> <span class=nx>App\Services\Chat\Providers</span><span class=p>;</span>

<span class=k>use</span> <span class=nx>Riak\Connection</span><span class=p>;</span>
<span class=k>use</span> <span class=nx>Illuminate\Support\ServiceProvider</span><span class=p>;</span>

<span class=k>class</span> <span class=nc>RiakServiceProvider</span> <span class=k>extends</span> <span class=nx>ServiceProvider</span>
<span class=p>{</span>
    <span class=sd>/**
</span><span class=sd>     * Register any application services.
</span><span class=sd>     *
</span><span class=sd>     * @return void
</span><span class=sd>     */</span>
    <span class=k>public</span> <span class=k>function</span> <span class=nf>register</span><span class=p>()</span>
    <span class=p>{</span>
        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>singleton</span><span class=p>(</span><span class=nx>Connection</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=k>function</span> <span class=p>(</span><span class=nv>$app</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=k>new</span> <span class=nx>Connection</span><span class=p>(</span><span class=nx>config</span><span class=p>(</span><span class=s1>&#39;riak&#39;</span><span class=p>));</span>
        <span class=p>});</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>Then register <code>RiakServiceProvider</code> in the service&rsquo;s provider to be automatically loaded whenever the service&rsquo;s provider is loadeo:</p><p><code>app/Services/Chat/Providers/ChatServiceProvider</code></p><div class=highlight><pre class=chroma><code class=language-php data-lang=php><span class=k>public</span> <span class=k>function</span> <span class=nf>regsiter</span><span class=p>()</span>
<span class=p>{</span>
    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>app</span><span class=o>-&gt;</span><span class=na>register</span><span class=p>(</span><span class=nx>RiakServiceProvider</span><span class=o>::</span><span class=na>class</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div><h2 ref=a-note-on-microservices>A Note On Microservices</h2><a class=anchor id=a-note-on-microservices></a><p>Talking about projects at scale may often lead us to talk about Microservices. Turning your Monolith services into
several instances of their own is one of the ways you may benefit from using services in a Monolith since each resembles a
Laravel project, and naturally in microservies we&rsquo;d create a separate Laravel
installation for each microservice, our Lucid services are ready for that due to the correspondence in structure;
nevertheless it would still require considerable effort to make the move but it is reduced significantly with this in hand,
especially that there will be much more to consider in the transformation.</p><div class="notices info"><p>This is likely to occur in a number of projects but certainly not all of them.</p></div><p>In Lucid terms: each of the services will become a Micro instance, preserving features & operations with their entrypoints and their tests.
What will be left as a dependency is domains and data which can be created in a package and shared among the microservices that require it.
Even though you may wish to also have proprietary domains in the services themselves which will be possible to do as well.</p><p>Visit <a href=https://docs.lucidarch.dev/micro-vs-monolith/>&ldquo;Micro vs. Monolith&rdquo;</a> for more.</p><h2 ref=soa--lucid>SOA & Lucid</h2><a class=anchor id=soa--lucid></a><p>When the word &ldquo;services&rdquo; is mentinoed it is invevitable to drift in thought towards Service-Orienter Architecture,
where controllers call a method from a &ldquo;service&rdquo; class that performs the work required. In most cases where this structure
is used, it was found that eventually services became the new controllers - large and full of unmaintainable logic.
In addition to the difficulty in sharing code between services due to the tight coupling with other components.</p><p>For that reason, Lucid services take it up a level to give the service a structure that allows it to grow, by organize its code
according to a familiar structure and expose its functionalities.</p><h3 ref=are-lucid-services-complient-to-soa>Are Lucid Services Complient to SOA?</h3><a class=anchor id=are-lucid-services-complient-to-soa></a><p>In brief, yes. However, there&rsquo;s a difference in the hierarchy:</p><ul><li>In SOA, the application layer is at the top, it includes the services that are needed and the application registers
and handles the routing, controller and directs the requests to the service&rsquo;s entrypoint.</li><li>Lucid Services on the other hand give that power to the service so that it implements all that is required from routes, controllers,
and the rest, and the application will only register the service.
This approach has proven to be efficient at scale due to the degree of separation, specifically with team collaboration, interoperability
and integrity.</li></ul><figure><img src=/media/images/services/soa.png alt="Lucid Service & Service-Oriented Architecture" width=500></figure></div><div class=chevrons><a class=next href=/domains/ title=Domains style=margin-right:0><div><p>Next page</p><label>Domains</label></div><i class="fas fa-arrow-right" style=font-size:1.7em></i></a></div></section><section class=right-menu><div class=TableOfContents><label><i class="fas fa-align-right"></i>&nbsp;&nbsp;What's on this page</label><nav><ul><li><a href=/services/>Services</a></li></ul></nav><nav id=TableOfContents><ul><li><a href=#structure>Structure</a><ul><li><a href=#routes-showcase>Routes Showcase</a></li><li><a href=#controllers-showcase>Controllers Showcase</a></li></ul></li><li><a href=#benefits>Benefits</a></li><li><a href=#create-a-service>Create a Service</a><ul><li><a href=#register-service>Register Service</a></li><li><a href=#run-service-tests>Run Service Tests</a></li></ul></li><li><a href=#working-with-services>Working with Services</a><ul><li><a href=#controllers>Controllers</a></li><li><a href=#features>Features</a></li><li><a href=#operations>Operations</a></li><li><a href=#migrations>Migrations</a></li><li><a href=#lang--views>Lang & Views</a></li><li><a href=#tests>Tests</a></li><li><a href=#providers>Providers</a></li></ul></li><li><a href=#a-note-on-microservices>A Note On Microservices</a></li><li><a href=#soa--lucid>SOA & Lucid</a><ul><li><a href=#are-lucid-services-complient-to-soa>Are Lucid Services Complient to SOA?</a></li></ul></li></ul></nav></div><div class=Actions><nav><ul><li><i class="fas fa-calendar"></i>Last update on 04 January 2021</li><li><i class="fas fa-user"></i>Last update by Abed Halawi</li></ul></nav></div></section></article><footer><div class=columns><div class=column><div style=font-family:Raleway!important><h3 style=color:#fdfdfd!important>lucid architecture</h3>for a scalable future software</div></div><div class=column><div style=display:flex;justify-content:flex-end;align-items:center><div style=align-items:center;display:flex><a href=https://lucidarch.dev target=_blank><img src=/icon/lucid-coloured.png alt="Lucid website link" width=28px style=margin-top:4px></a>
<a href=https://github.com/lucidarch target=_blank style=margin-left:10px><i class="fab fa-github fa-lg"></i></a><a href=https://lucid-slack.herokuapp.com target=_blank style=margin-left:10px><i class="fab fa-slack fa-lg"></i></a><a href=https://www.reddit.com/r/lucidarch target=_blank style=margin-left:10px><i class="fab fa-reddit-alien fa-lg"></i></a></div><div style=margin-left:50px;margin-top:6px><a class=github-button href=https://github.com/sponsors/lucid-architecture data-icon=octicon-heart aria-label="Sponsor @lucid-architecture on GitHub">Sponsor</a>
<a class=github-button href=https://github.com/ntkme/github-buttons data-icon=octicon-star data-show-count=true aria-label="Star ntkme/github-buttons on GitHub">Star</a></div></div></div></div></footer></body></html>