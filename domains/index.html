<!doctype html><html><head><title>Domains :: Lucid</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=revised content="2022-11-15T09:44:08 UTC"><meta name=description content><title>Domains :: Lucid</title><link rel="shortcut icon" href=/images/favicon.png type=image/x-icon><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css integrity=sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.css><script src=https://code.jquery.com/jquery-3.5.1.min.js></script>
<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel=stylesheet><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/layout.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/css/style.main.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/css/style.menu.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/notice.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/tabs.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/panel.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/columns.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/children.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/attachments.css><link rel=stylesheet type=text/css href=https://docs.lucidarch.dev/sass/shortcodes/alert.css><link rel=stylesheet type=text/css href=/css/docport.css><script src=/js/docport.js></script>
<script type=text/javascript>var baseurl="https://docs.lucidarch.dev"</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-96232175-1","auto"),ga("send","pageview"))</script><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=/css/syntax.css><link rel=apple-touch-icon sizes=180x180 href=/icon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/icon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/icon/favicon-16x16.png><link rel=manifest href=/icon/site.webmanifest><script async defer src=https://buttons.github.io/buttons.js></script></head><body data-url=/domains/ class=hideheader><style type=text/css>#debug{display:-webkit-box;display:-ms-flexbox;display:flex;line-height:3.5rem;margin-bottom:.35rem;padding:0 2rem;position:fixed;left:0;right:0;top:0;top:0;min-height:150px;background-color:#fff;border:3px solid red;z-index:10000;word-wrap:all;overflow:auto}</style><article><aside><div class=search><div class=searchbox><input data-search-input id=search-by type=text placeholder="Type to search..."></div><script type=text/javascript src=/vendor/lunr/lunr.min.js></script>
<script type=text/javascript src=/vendor/auto-complete/auto-complete.js></script>
<link href=/vendor/auto-complete/auto-complete.css rel=stylesheet><script type=text/javascript>var baseurl="https://docs.lucidarch.dev"</script><script type=text/javascript src=/js/search.js></script></div><div style=margin-top:30px><a href=/concept style=display:flex;justify-content:left;align-items:center><img src=/icon/logo.png width=250 style=margin-left:10px></a></div><div id=close_menu><a href=javascript:void(0); style=font-size:15px onclick='$("article > aside").toggleClass("responsive")'><i class="fa fa-lg fa-times"></i></a></div><ul class=menu><li data-nav-id=https://docs.lucidarch.dev/concept/ class="dd-item
item_level_$level"><a href=/concept/>Concept</a></li><li data-nav-id=https://docs.lucidarch.dev/philosophy/ class="dd-item
item_level_$level"><a href=/philosophy/>Philosophy</a></li><li data-nav-id=https://docs.lucidarch.dev/principles/ class="dd-item
item_level_$level"><a href=/principles/>Principles</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/installation/ class="dd-item
item_level_$level"><a href=/installation/>Installation</a></li><li data-nav-id=https://docs.lucidarch.dev/upgrade-guide/ class="dd-item alwaysopen
item_level_$level"><a href=/upgrade-guide/>Upgrade Guide</a></li><li data-nav-id=https://docs.lucidarch.dev/contribution-guide/ class="dd-item
item_level_$level"><a href=/contribution-guide/>Contribution Guide</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/getting-started/ class="dd-item alwaysopen
item_level_$level"><a href=/getting-started/>Getting Started</a></li><li data-nav-id=https://docs.lucidarch.dev/micro-vs-monolith/ class="dd-item
item_level_$level"><a href=/micro-vs-monolith/>Micro • Monolith</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/routing/ class="dd-item
item_level_$level"><a href=/routing/>Routing</a></li><li data-nav-id=https://docs.lucidarch.dev/controllers/ class="dd-item
item_level_$level"><a href=/controllers/>Controllers</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/features/ class="dd-item
item_level_$level"><a href=/features/>Features</a></li><li data-nav-id=https://docs.lucidarch.dev/jobs/ class="dd-item
item_level_$level"><a href=/jobs/>Jobs</a></li><li data-nav-id=https://docs.lucidarch.dev/operations/ class="dd-item
item_level_$level"><a href=/operations/>Operations</a></li><li data-nav-id=https://docs.lucidarch.dev/services/ class="dd-item
item_level_$level"><a href=/services/>Services</a></li><li data-nav-id=https://docs.lucidarch.dev/domains/ class="dd-item active
item_level_$level"><a href=/domains/>Domains</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/testing/ class="dd-item
item_level_$level"><a href=/testing/>Testing</a></li><li data-nav-id=https://docs.lucidarch.dev/database/ class="dd-item
item_level_$level"><a href=/database/>Database</a></li><li data-nav-id=https://docs.lucidarch.dev/validation/ class="dd-item
item_level_$level"><a href=/validation/>Validation</a></li><hr><li data-nav-id=https://docs.lucidarch.dev/cli/ class="dd-item
item_level_$level"><a href=/cli/>CLI Reference</a></li></ul></aside><section class=page><nav id=ariane aria-label=breadcrumb><ol class=ariane><li><a class=text-link href=https://docs.lucidarch.dev>Home</a></li><li class=active>Domains</li></ol></nav><h1>Domains</h1><div class=jump-to-section><span onclick='$h=$(this),$h.next("nav").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("nav").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><span class="fas fa-align-right"></span>
Jump to Section
<i class="fas fa-chevron-right"></i></span><nav id=TableOfContents><ul><li><a href=#characteristics>Characteristics</a></li><li><a href=#what-goes-into-a-domain>What Goes Into A Domain</a></li><li><a href=#testing>Testing</a></li></ul></nav></div><div class=content><p>Inspired by Domain-Driven Development, this piece of the Lucid stack is merely directories that are all about organizing and categorizing
code according to the topic they belong to.</p><p>There is no specific way of naming them because it differs per case, but according to our experience over
the years we found that they&rsquo;re usually of two types, the &ldquo;internal&rdquo; and the &ldquo;external&rdquo; type of domain. Here are a few examples
to illustrate the difference</p><div class=columns><div class=column><p><strong>Internal</strong></p><ul><li>Http<ul><li><code>RespondWithJsonJob</code></li><li><code>RespondWithJsonErrorJob</code></li><li><code>RespondWithHtmlJob</code></li><li><code>RespondWithHtmlErrorJob</code></li><li><code>RespondWithViewJob</code></li></ul></li><li>Chat<ul><li><code>SendMessageToChannelJob</code></li></ul></li></ul></div><div class=column><p><strong>External</strong></p><ul><li>GitHub<ul><li><code>LoginWithGitHubJob</code></li><li><code>FetchGitHubReposJob</code></li></ul></li><li>Facebook<ul><li><code>LoginWithFacebookJob</code></li><li><code>FetchUserPostsJob</code></li></ul></li></ul></div></div><p>Even though they differ in the nature of functionalities they expose, these are still domains from which our application would
(re)use code wherever possible. This separation is only logical to help with the understanding of domains but is not an actual
separation in code.</p><h2 ref=characteristics>Characteristics</h2><a class=anchor id=characteristics></a><ul><li><strong>Isolation</strong>: Domains operate in isolation in the sense that they should never need anything from another domain to accomplish their job.
They may, however, use elements from the framework or Foundation for abstraction reasons and to eliminate code replication.</li><li><strong>Encapsulation</strong>: Ideally, domains should be structured in a way that would allow them to be moved around with the least amount
of impact on their output. They contain their jobs, requests/validation, tests and other custom classes to get their job done.</li></ul><p>Consider domain jobs to be the pieces of code that will be shared and reused the most, they can be called from anywhere
which makes it essential that they do not depend on any other domain.</p><h2 ref=what-goes-into-a-domain>What Goes Into A Domain</h2><a class=anchor id=what-goes-into-a-domain></a><p>From the Lucid stack, domains contain Job classes and their tests, acting as the only way of communicating with a domain.
However any other class that belongs to the domain should also be present there for centralisation.</p><p>Consider the example of an application that integrates with GitHub to login as a GitHub user and
it allows to fetch a repository&rsquo;s info from GitHub&rsquo;s API:</p><pre>
app/Domains/GitHub
├── GitHubClient.php
├── Jobs
│   ├── FetchGitHubRepoInfoJob.php
│   └── LoginWithGitHubJob.php
├── Exceptions
│   ├── InvalidTokenException.php
│   └── RepositoryNotFoundException.php
└── Tests
    └── GitHubClientTest.php
    └── Jobs
        ├── FetchGitHubReposJobTest.php
        └── LoginWithGitHubJobTest.php
</pre><ul><li><code>GitHubClient</code> is the class that the jobs use to communicate with GitHub&rsquo;s API.</li><li><code>FetchGitHubRepoInfoJob</code> contains all the details required to call the API such as URL and query params,
exposing them through parameters in the signature, and using the rest of the classes from the domain:</li></ul><div class="notices danger"><p><i class="fas fa-exclamation-triangle"></i> This code snippet is fictional, it is for demonstrative purposes only and is not meant to work as-is in real life.</p></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nx>App\Domains\GitHub\Jobs</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Lucid\Units\Job</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Domains\GitHub\GitHubClient</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Domains\GitHub\Exceptions\InvalidTokenException</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>App\Domains\GitHub\Exceptions\RepositoryNotFoundException</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>FetchGitHubRepoInfoJob</span> <span class=k>extends</span> <span class=nx>Job</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$includeCollaborators</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(</span><span class=nv>$name</span><span class=p>,</span> <span class=nv>$includeCollaborators</span> <span class=o>=</span> <span class=k>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>name</span> <span class=o>=</span> <span class=nv>$name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>includeCollaborators</span> <span class=o>=</span> <span class=nv>$includeCollaborators</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>handle</span><span class=p>(</span><span class=nx>GitHubClient</span> <span class=nv>$github</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$params</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>includeCollaborators</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nv>$params</span> <span class=o>=</span> <span class=s1>&#39;with_collaborators&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$response</span> <span class=o>=</span> <span class=nv>$github</span><span class=o>-&gt;</span><span class=na>repo</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>name</span><span class=p>,</span> <span class=nv>$params</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>switch</span><span class=p>(</span><span class=nv>$response</span><span class=o>-&gt;</span><span class=na>status</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>404</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>throw</span> <span class=k>new</span> <span class=nx>RepositoryNotFoundException</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>case</span> <span class=mi>403</span><span class=o>:</span>
</span></span><span class=line><span class=cl>                <span class=k>throw</span> <span class=k>new</span> <span class=nx>InvalidTokenException</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$response</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 ref=testing>Testing</h2><a class=anchor id=testing></a><p>Domains contain the tests of their jobs and classes in order to be self-sufficient. They are considered to be unit tests
so that the domain can provide the guarantee of a working unit, that way we focus on feature tests in the rest of the application.</p><p>When generating Jobs, their tests are automatically generated in the corresponding locations:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>lucid make:job FetchGitHubRepoInfoJob GitHub
</span></span></code></pre></div><p>Will generate two files:</p><ol><li><code>app/Domains/GitHub/Jobs/FetchGitHubRepoInfoJob.php</code></li><li><code>tests/Unit/Domains/GitHub/Jobs/FetchGitHubRepoInfoJobTest.php</code></li></ol></div><div class=chevrons><a class=next href=/testing/ title=Testing style=margin-right:0><div><p>Next page</p><label>Testing</label></div><i class="fas fa-arrow-right" style=font-size:1.7em></i></a></div></section><section class=right-menu><div class=TableOfContents><label><i class="fas fa-align-right"></i>&nbsp;&nbsp;What's on this page</label><nav><ul><li><a href=/domains/>Domains</a></li></ul></nav><nav id=TableOfContents><ul><li><a href=#characteristics>Characteristics</a></li><li><a href=#what-goes-into-a-domain>What Goes Into A Domain</a></li><li><a href=#testing>Testing</a></li></ul></nav></div><div class=Actions><nav><ul><li><i class='fas fa-calendar'></i>
Last update on 15 November 2022</li><li title><i class='fas fa-user'></i>
Last update by Abed Halawi</li></ul></nav></div></section></article><footer><div class=columns><div class=column><div style=font-family:Raleway!important><h3 style=color:#fdfdfd!important>lucid architecture</h3>for a scalable future software</div></div><div class=column><div style=display:flex;justify-content:flex-end;align-items:center><div style=align-items:center;display:flex><a href=https://lucidarch.dev target=_blank><img src=/icon/lucid-coloured.png alt="Lucid website link" width=28px style=margin-top:4px></a>
<a href=https://github.com/lucidarch target=_blank style=margin-left:10px><i class="fab fa-github fa-lg"></i></a>
<a href=https://lucid-slack.herokuapp.com target=_blank style=margin-left:10px><i class="fab fa-slack fa-lg"></i></a>
<a href=https://www.reddit.com/r/lucidarch target=_blank style=margin-left:10px><i class="fab fa-reddit-alien fa-lg"></i></a></div><div style=margin-left:50px;margin-top:6px><a class=github-button href=https://github.com/sponsors/lucidarch data-icon=octicon-heart aria-label="Sponsor @lucidarch on GitHub">Sponsor</a>
<a class=github-button href=https://github.com/lucidarch/lucid data-icon=octicon-star data-show-count=true aria-label="Star lucidarch/lucid on GitHub">Star</a></div></div></div></div></footer></body></html>